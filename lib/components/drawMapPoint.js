"use strict";const n=require("vue"),c=require("./utils.js");require("../node_modules/@antv/l7-draw/dist/l7-draw.js");const p=require("../_virtual/l7-draw.js"),w=n.defineComponent({name:"drawMapPoint",props:{center:{type:Object,default:()=>[]},zoom:{type:Number,default:7},point:{type:Array,default:()=>[]},isMulti:{type:Boolean,default:!1},option:{type:Object,default:()=>({})}},emits:["change"],setup(f,s){let e=n.toRefs(f),d=n.ref(null),l,r=n.ref([]),o;n.onMounted(()=>{c.default(d.value,{...e.option.value,zoom:e.zoom.value,center:e.center.value}).then(a=>{l=a,l.addImage("location","http://img.xd.sidwit.com/picture-bed/map/location.png"),e.point.value&&e.point.value.length>0&&c.flyTo(l.map,e.point.value[0],15),o=new p.l7Draw.exports.DrawPoint(l,{initialData:v(e.point.value),multiple:e.isMulti.value,style:{point:{normal:{shape:"location",size:20},active:{shape:"location",size:20},hover:{shape:"location",size:20}}}}),o.enable(),o.on(p.l7Draw.exports.DrawEvent.Add,(u,t)=>{let i=null;e.isMulti.value||(e.point.value&&e.point.value.length>0&&(i=v(e.point.value)[0]),t.length>1&&(i=t[0]),i&&o.removeFeature(i))}),o.on(p.l7Draw.exports.DrawEvent.Change,u=>{let t=u;if(t&&t.length>0){let i=[];t.map(m=>{let g=m.geometry.coordinates;i.push(g.join(","))}),r.value=i}else r.value=[]})})});function v(a=[]){return!a||a.length===0?null:a.map(u=>{let t=u.split(",");return{type:"Feature",properties:{},geometry:{type:"Point",coordinates:[+t[0],+t[1]]}}})}function h(){return r.value}return n.onBeforeUnmount(()=>{l&&l.destroy(),o&&o.destroy()}),n.watch(r,a=>{s.emit("change",a)}),s.expose({getData:h}),()=>n.h("div",{style:"width:100%;height:100%;position:relative;"},[n.h("div",{class:"mapContainer",ref:d,style:"width:100%;height:100%;"})])}});module.exports=w;
